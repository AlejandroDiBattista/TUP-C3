<html lang="es">
<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />

    <title>Legajo: 58881</title>
</head>

<body>
    <div id="root"></div>
    <script type="text/babel">
    const { useState } = React;

    const ProductosStock = [
        { 
            id: 1, 
            producto: "Guitarra Electrica Fender", 
            stock: "8", 
            codigo: "040392856178" },
        { 
            id: 2, 
            producto: "Bajo Electrico Ibanez ", 
            stock: "6", 
            codigo: "192857604231" },
        { 
            id: 3, 
            producto: "Teclado Yamaha", 
            stock: "8", 
            codigo: "301485697248" },
        {
            id: 4,
            producto: "Batería Pearl",
            stock: "4",
            codigo: "487126354970",
        },
        {
            id: 5,
            producto: "Violin Stradivarius",
            stock: "3",
            codigo: "576819042356",
        },
        {
            id: 6,
            producto: "Amplificador Marshall",
            stock: "8",
            codigo: "623948571020",
        },
        {
            id: 7,
            producto: "Amplificador Ampeg",
            stock: "6",
            codigo: "734109582437",
        },
        {
            id: 8,
            producto: "Microfonos Shure",
            stock: "10",
            codigo: "859623741509",
        },
    ];

    function Editar({ Producto, alaceptar, alCancelar }) {
        let [producto, setproducto] = useState(Producto.producto);
        let [stock, setstock] = useState(Producto.stock);
        let [codigo, setcodigo] = useState(Producto.codigo);
        let [error, setError] = useState(false);

        const cambiarproducto = (e) => {
            setproducto(e.target.value);
            setError(false);
        };
        const cambiarstock = (e) => {
            setstock(e.target.value);
            setError(false);
        };
        const cambiarcodigo = (e) => {
            setcodigo(e.target.value);
            setError(false);
        };

        const aceptar = (e) => {
        e.preventDefault();
        if (
            producto.trim() === "" ||
            stock.trim() === "" ||
            codigo.trim() === ""
        ) {
            setError(true);
            return;
        }
        alaceptar({ ...Producto, producto, stock, codigo });
        };
        const cancelar = (e) => {
            e.preventDefault();
            alCancelar();
        };
        return (
        <>
            <form className="formulario">
            <input type="text" value={producto} onChange={cambiarproducto} />

            <input type="text" value={stock} onChange={cambiarstock} />

            <input type="text" value={codigo} onChange={cambiarcodigo} />
            {error && (
                <p className="error">Todos los campos son obligatorios</p>
            )}

            <div className="acciones">
                <button onClick={aceptar}>Aceptar</button>
                <button onClick={cancelar}>Cancelar</button>
            </div>
            </form>
        </>
        );
    }

    function Mostrar({ Producto, alEditar, alBorrar }) {
        const editar = (e) => alEditar();
        const borrar = (e) => alBorrar();
        return (
        <>
            <div className="panel">
                <div className= "stock">
                    {Producto.stock}
                </div>
                <div className= "nomcod">
                    <h2>
                    {Producto.producto}
                    </h2>
                    <p>
                    {Producto.codigo}
                    </p>
                </div>
                <div className="iconos">
                    <span className = "spanEditar" onClick = {editar}>
                        <i class="fa-regular fa-pen-to-square"></i>
                    </span>

                    <span className = "spanBorrar" onClick = {borrar}>
                        <i class="fa-regular fa-trash-can"></i>
                    </span>
                </div>
            </div>
        </>
        );
    }

    function Lista({ Productos, alAgregar, alEditar, alBorrar }) {
        if (Productos.length === 0) return <h1>No hay Productos</h1>;

        return (
        <>
            <div className="titulo">
                    <h1>Listado Déposito</h1>
                <span className = "spanAgregar" onClick={() => alAgregar()}>
                    <i class="fa-regular fa-square-plus"></i>
                </span>
            </div>

            {Productos.map((Producto) => (
                <Mostrar
                    Producto={Producto}
                    alEditar={() => alEditar(Producto.id)}
                    alBorrar={() => alBorrar(Producto.id)}
                />
            ))}
        </>
        );
    }

    function ordenAlfabetico(a, b) {
        if (a.producto < b.producto) return -1;
        if (a.producto > b.producto) return 1;
        return 0;
    }
    

    function App() {
        let [Producto, setProducto] = useState({});
        let [editando, setEditando] = useState(false);
        let [Productos, setProductos] = useState(ProductosStock);

        const aceptar = (Producto) => {
            if (Producto.id) {
                // Modificacion
                let copia = Productos.map((c) =>
                c.id === Producto.id ? Producto : c
                );
                setProductos(copia);
            } else {
                // Alta
                let id = Math.max(...Productos.map((c) => c.id)) + 1;
                let copia = [...Productos, { ...Producto, id }];
                setProductos(copia);
            }
            setEditando(false);
        };

        const cancelar = () => {
            setProducto({});
            setEditando(false);
            console.log("Cancelar");
        };

        const agregar = () => {
            setProducto({});
            setEditando(true);
        };

        const editar = (id) => {
            let Producto = Productos.find((c) => c.id === id);
            setProducto(Producto);
            setEditando(true);
        };

        const borrar = (id) => {
        
        let copia = Productos.filter((c) => c.id !== id);
        setProductos(copia);
        };

        Productos.sort(ordenAlfabetico);
        return (
        <>
            {editando ? (
                <Editar
                    Producto={Producto}
                    alaceptar={aceptar}
                    alCancelar={cancelar}
                />
            ) : (
                <Lista
                    Productos={Productos}
                    alAgregar={agregar}
                    alEditar={editar}
                    alBorrar={borrar}
                />
            )}
        </>
        );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
    </script>
</body>
</html>
